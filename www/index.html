<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WebWebCam Broadcaster</title>
</head>
<script>
const homePage = "https://github.com/chadwallacehart/webwebcam";


const thisUrl = new URL(window.location);
console.log(thisUrl);

const host = thisUrl.host;
const pathname = thisUrl.pathname;
const search = thisUrl.search;


let destination = homePage;

const urlParams = new URLSearchParams(thisUrl.search);
if (urlParams.has("i") || urlParams.has("id")) {
    peerId = urlParams.get("i");
    console.log(`Using peerid ${peerId} from URL params`);
    const pathnameNoFile = thisUrl.pathname.replace(/index\.html\/?/i, ""); //assume index.html
    destination = `https://${host}${pathnameNoFile}remote.html${search}`;
}


if(thisUrl.pathname.includes("/index.htm"))
    //destination = `https://${host}/index.html${search}`;
    destination = homePage;

else if(thisUrl.pathname.includes("/remote.htm"))
    destination = `https://${host}/remote.html${search}`;

else if(thisUrl.pathname.match("/.htm"))
    destination = `https://${host}${pathname}${search}`;

//ToDo: Failed attempt at routes; need node.js
// else if(thisUrl.pathname.match(/index.html\/[a-zA-Z0-9]{8,20}/g))
//     destination = `https://${host}/remote.html?id=${pathname}`;

console.log(destination);
location.assign(destination);

document.addEventListener('DOMContentLoaded', () => {
    const remoteA = document.querySelector('a');
    remoteA.href = remoteUrl;
    console.log('DOM fully loaded and parsed');
});

</script>
<body>
<p>If you see this then something went wrong.</p>
<p>Click <a id="remoteHref" href="#">here</a> to connect your remote device/phone to the extension.</p>
<p>For information on the project, please visit [ToDo: add overview page].</p>
<p>Visit [add Chrome webstore url] to download and install the extension.</p>
<p>If you are a developer interested in the project, then please visit [add github url].</p>
</body>
</html>
